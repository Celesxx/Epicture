name: Kotlin build

on:
  push:
    branches:
    - develop
  pull_request:
    branches:
    - develop

jobs: 
  build:
    runs-on: ubuntu-latest

    steps: 
      

      - name: set up JDK
        uses: actions/setup-java@v1
        with: 
          java-version: 15.0.2


      - name: Emplacement of racine file
        run: ls -ali
      
      
      - name: Emplacement of racine file
        run: dir


      - name: Make gradlew executable
        run: chmod +x ./epicture_project/gradlew


      - name: Build with Gradle
        run: ./epicture_project/gradlew build

      - name: Build Debug APK
        run: ./gradlew assembleDebug


      - name: Releasing apk
        uses: Celesxx/Epicture@main
        env:
          GITHUB_TOKEN: ${{ secrets.TOKEN }}
          APP_FOLDER: ./
          RELEASE_TITLE: New Build


      
      - name: pull-request
        uses: actions/checkout@v2
        uses: repo-sync/pull-request@v2
        with:
          destination_branch: "main"
          github_token: ${{ secrets.GITHUB_TOKEN }}